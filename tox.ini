[pytest]
addopts = -ra
testpaths = tests
filterwarnings =
    once::Warning
    ignore:::pympler[.*]

[gh-actions]
python =
    3.8: py38
    3.9: py39
    3.10: py310
    3.11: py311, lint, docs

[tox]
envlist =
    lint
    py{38, 39, 310}-django{3.2, 4.1, 4.2}-drf3.14
    py{311}-django{4.1, 4.2}-drf3.14
    docs
isolated_build = True

[testenv]
commands = pytest {posargs}
deps =
    django3.2: Django==3.2.*
    django4.1: Django==4.1.*
    django4.2: Django==4.2.*
    drf3.14: djangorestframework==3.14.*
    pytest-django

[testenv:lint]
basepython = python3.11
extras = dev
passenv = HOMEPATH                    # needed on Windows
commands = pre-commit run --all-files

[testenv:docs]
basepython = python3.11
extras = docs
commands = mkdocs build
